CREATE SCHEMA vulnerabilities;

CREATE TABLE vulnerabilities (
  id bigserial NOT NULL PRIMARY KEY,
  program_id bigserial NOT NULL,
  url text NOT NULL,
  tag text NOT NULL,
  type text NOT NULL,
  severity text NOT NULL,
  favourite boolean NOT NULL DEFAULT false,
  created_at timestamp NOT NULL DEFAULT now(),
  updated_at timestamp NOT NULL DEFAULT now(),
  CONSTRAINT unique_vulnerability UNIQUE (program_id, url, type),
  FOREIGN KEY (program_id) REFERENCES program(id)
);
